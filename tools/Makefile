# ROOT_DIR := $(abspath ../../)
# include $(ROOT_DIR)/build-scripts/variables.mk

build: clean
	pipenv sync --dev
	pipenv run python -m grpc_tools.protoc -Iamaas/grpc/protos=./amaas/protos \
		--python_out=. \
		--pyi_out=. \
		--grpc_python_out=. \
		./amaas/protos/scan.proto
	pipenv run pipenv-setup sync
	pipenv run python setup.py sdist bdist_wheel

upload:
	pipenv run twine upload ./dist/*.whl --repository-url $(JFROG_REGISTRY_PYPI) --non-interactive --verbose

clean:
	@rm -rf dist build amaas/*.egg-info amaas/grpc/protos/
